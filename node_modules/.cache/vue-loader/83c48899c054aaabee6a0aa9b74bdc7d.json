{"remainingRequest":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/MAC1/javaproject/eladmin-web/src/views/system/user/center.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/MAC1/javaproject/eladmin-web/src/views/system/user/center.vue","mtime":1619011782554},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport myUpload from 'vue-image-crop-upload'\nimport { mapGetters } from 'vuex'\nimport updatePass from './center/updatePass'\nimport updateEmail from './center/updateEmail'\nimport { getToken } from '@/utils/auth'\nimport store from '@/store'\nimport { isvalidPhone } from '@/utils/validate'\nimport crud from '@/mixins/crud'\nimport { editUser } from '@/api/system/user'\nimport Avatar from '@/assets/images/avatar.png'\nexport default {\n  name: 'Center',\n  components: { updatePass, updateEmail, myUpload },\n  mixins: [crud],\n  data() {\n    // 自定义验证\n    const validPhone = (rule, value, callback) => {\n      if (!value) {\n        callback(new Error('请输入电话号码'))\n      } else if (!isvalidPhone(value)) {\n        callback(new Error('请输入正确的11位手机号码'))\n      } else {\n        callback()\n      }\n    }\n    return {\n      show: false,\n      Avatar: Avatar,\n      activeName: 'first',\n      saveLoading: false,\n      headers: {\n        'Authorization': getToken()\n      },\n      form: {},\n      rules: {\n        nickName: [\n          { required: true, message: '请输入用户昵称', trigger: 'blur' },\n          { min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'blur' }\n        ],\n        phone: [\n          { required: true, trigger: 'blur', validator: validPhone }\n        ]\n      }\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'user',\n      'updateAvatarApi',\n      'baseApi'\n    ])\n  },\n  created() {\n    this.form = { id: this.user.id, nickName: this.user.nickName, gender: this.user.gender, phone: this.user.phone }\n    store.dispatch('GetInfo').then(() => {})\n  },\n  methods: {\n    toggleShow() {\n      this.show = !this.show\n    },\n    handleClick(tab, event) {\n      if (tab.name === 'second') {\n        this.init()\n      }\n    },\n    beforeInit() {\n      this.url = 'api/logs/user'\n      return true\n    },\n    cropUploadSuccess(jsonData, field) {\n      store.dispatch('GetInfo').then(() => {})\n    },\n    doSubmit() {\n      if (this.$refs['form']) {\n        this.$refs['form'].validate((valid) => {\n          if (valid) {\n            this.saveLoading = true\n            editUser(this.form).then(() => {\n              this.editSuccessNotify()\n              store.dispatch('GetInfo').then(() => {})\n              this.saveLoading = false\n            }).catch(() => {\n              this.saveLoading = false\n            })\n          }\n        })\n      }\n    }\n  }\n}\n",null]}