{"remainingRequest":"/Volumes/MAC1/javaproject/Sober-web1/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/MAC1/javaproject/Sober-web1/src/views/tools/storage/local/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/MAC1/javaproject/Sober-web1/src/views/tools/storage/local/index.vue","mtime":1619011782557},{"path":"/Volumes/MAC1/javaproject/Sober-web1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/Sober-web1/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/MAC1/javaproject/Sober-web1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/Sober-web1/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from 'vuex'\nimport { getToken } from '@/utils/auth'\nimport crudFile from '@/api/tools/localStorage'\nimport CRUD, { presenter, header, form, crud } from '@crud/crud'\nimport rrOperation from '@crud/RR.operation'\nimport crudOperation from '@crud/CRUD.operation'\nimport pagination from '@crud/Pagination'\nimport DateRangePicker from '@/components/DateRangePicker'\n\nconst defaultForm = { id: null, name: '' }\nexport default {\n  components: { pagination, crudOperation, rrOperation, DateRangePicker },\n  cruds() {\n    return CRUD({ title: '文件', url: 'api/localStorage', crudMethod: { ...crudFile }})\n  },\n  mixins: [presenter(), header(), form(defaultForm), crud()],\n  data() {\n    return {\n      delAllLoading: false,\n      loading: false,\n      headers: { 'Authorization': getToken() },\n      permission: {\n        edit: ['admin', 'storage:edit'],\n        del: ['admin', 'storage:del']\n      }\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'baseApi',\n      'fileUploadApi'\n    ])\n  },\n  created() {\n    this.crud.optShow.add = false\n  },\n  methods: {\n    // 上传文件\n    upload() {\n      this.$refs.upload.submit()\n    },\n    beforeUpload(file) {\n      let isLt2M = true\n      isLt2M = file.size / 1024 / 1024 < 100\n      if (!isLt2M) {\n        this.loading = false\n        this.$message.error('上传文件大小不能超过 100MB!')\n      }\n      this.form.name = file.name\n      return isLt2M\n    },\n    handleSuccess(response, file, fileList) {\n      this.crud.notify('上传成功', CRUD.NOTIFICATION_TYPE.SUCCESS)\n      this.$refs.upload.clearFiles()\n      this.crud.status.add = CRUD.STATUS.NORMAL\n      this.crud.resetForm()\n      this.crud.toQuery()\n    },\n    // 监听上传失败\n    handleError(e, file, fileList) {\n      const msg = JSON.parse(e.message)\n      this.$notify({\n        title: msg.message,\n        type: 'error',\n        duration: 2500\n      })\n      this.loading = false\n    }\n  }\n}\n",null]}