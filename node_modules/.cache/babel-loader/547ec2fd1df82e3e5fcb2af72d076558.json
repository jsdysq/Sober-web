{"remainingRequest":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/babel-loader/lib/index.js!/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Volumes/MAC1/javaproject/eladmin-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/MAC1/javaproject/eladmin-web/src/views/tools/aliPay/toPay.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/MAC1/javaproject/eladmin-web/src/views/tools/aliPay/toPay.vue","mtime":1619011782556},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _alipay = require(\"@/api/tools/alipay\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  data: function data() {\n    return {\n      url: '',\n      // 新窗口的引用\n      newWin: null,\n      loading: false,\n      form: {\n        subject: '',\n        totalAmount: '',\n        body: ''\n      },\n      rules: {\n        subject: [{\n          required: true,\n          message: '商品名称不能为空',\n          trigger: 'blur'\n        }],\n        totalAmount: [{\n          required: true,\n          message: '商品价格不能为空',\n          trigger: 'blur'\n        }],\n        body: [{\n          required: true,\n          message: '商品描述不能为空',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  watch: {\n    url: function url(newVal, oldVal) {\n      if (newVal && this.newWin) {\n        this.newWin.sessionStorage.clear();\n        this.newWin.location.href = newVal; // 重定向后把url和newWin重置\n\n        this.url = '';\n        this.newWin = null;\n      }\n    }\n  },\n  methods: {\n    doSubmit: function doSubmit() {\n      var _this = this;\n\n      this.$refs['form'].validate(function (valid) {\n        if (valid) {\n          _this.loading = true; // 先打开一个空的新窗口，再请求\n\n          _this.newWin = window.open();\n          var url = '';\n\n          if (/(Android)/i.test(navigator.userAgent)) {\n            // 判断是否为Android手机\n            url = 'aliPay/toPayAsWeb';\n          } else if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {\n            // 判断是否为苹果手机\n            url = 'aliPay/toPayAsWeb';\n          } else {\n            url = 'aliPay/toPayAsPC';\n          }\n\n          (0, _alipay.toAliPay)(url, _this.form).then(function (res) {\n            _this.loading = false;\n            _this.url = res;\n          }).catch(function (err) {\n            _this.loading = false;\n            console.log(err.response.data.message);\n          });\n        } else {\n          return false;\n        }\n      });\n    }\n  }\n};\nexports.default = _default;",null]}