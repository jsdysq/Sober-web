{"remainingRequest":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/babel-loader/lib/index.js!/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Volumes/MAC1/javaproject/eladmin-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/MAC1/javaproject/eladmin-web/src/views/tools/email/send.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/MAC1/javaproject/eladmin-web/src/views/tools/email/send.vue","mtime":1619011782556},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/MAC1/javaproject/eladmin-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Volumes/MAC1/javaproject/eladmin-web/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"/Volumes/MAC1/javaproject/eladmin-web/node_modules/@babel/runtime-corejs2/helpers/objectSpread2\"));\n\nvar _email = require(\"@/api/tools/email\");\n\nvar _upload = require(\"@/utils/upload\");\n\nvar _validate = require(\"@/utils/validate\");\n\nvar _vuex = require(\"vuex\");\n\nvar _wangeditor = _interopRequireDefault(require(\"wangeditor\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'Index',\n  data: function data() {\n    return {\n      loading: false,\n      form: {\n        subject: '',\n        tos: [],\n        content: ''\n      },\n      tos: [{\n        value: ''\n      }],\n      rules: {\n        subject: [{\n          required: true,\n          message: '标题不能为空',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  computed: (0, _objectSpread2.default)({}, (0, _vuex.mapGetters)(['imagesUploadApi'])),\n  mounted: function mounted() {\n    var _this2 = this;\n\n    var _this = this;\n\n    var editor = new _wangeditor.default(this.$refs.editor); // 自定义菜单配置\n\n    editor.customConfig.zIndex = 10; // 文件上传\n\n    editor.customConfig.customUploadImg = function (files, insert) {\n      // files 是 input 中选中的文件列表\n      // insert 是获取图片 url 后，插入到编辑器的方法\n      files.forEach(function (image) {\n        files.forEach(function (image) {\n          (0, _upload.upload)(_this.imagesUploadApi, image).then(function (data) {\n            insert(data.data.url);\n          });\n        });\n      });\n    };\n\n    editor.customConfig.onchange = function (html) {\n      _this2.form.content = html;\n    };\n\n    editor.create();\n  },\n  methods: {\n    removeDomain: function removeDomain(item) {\n      var index = this.tos.indexOf(item);\n\n      if (index !== -1 && this.tos.length !== 1) {\n        this.tos.splice(index, 1);\n      } else {\n        this.$message({\n          message: '请至少保留一位联系人',\n          type: 'warning'\n        });\n      }\n    },\n    addDomain: function addDomain() {\n      this.tos.push({\n        value: '',\n        key: Date.now()\n      });\n    },\n    doSubmit: function doSubmit() {\n      var _this3 = this;\n\n      var _this = this;\n\n      this.$refs['form'].validate(function (valid) {\n        _this3.form.tos = [];\n\n        if (valid) {\n          var sub = false;\n\n          _this3.tos.forEach(function (data, index) {\n            if (data.value === '') {\n              _this.$message({\n                message: '收件邮箱不能为空',\n                type: 'warning'\n              });\n\n              sub = true;\n            } else if ((0, _validate.validEmail)(data.value)) {\n              _this.form.tos.push(data.value);\n            } else {\n              _this.$message({\n                message: '收件邮箱格式错误',\n                type: 'warning'\n              });\n\n              sub = true;\n            }\n          });\n\n          if (sub) {\n            return false;\n          }\n\n          _this3.loading = true;\n          (0, _email.send)(_this3.form).then(function (res) {\n            _this3.$notify({\n              title: '发送成功',\n              type: 'success',\n              duration: 2500\n            });\n\n            _this3.loading = false;\n          }).catch(function (err) {\n            _this3.loading = false;\n            console.log(err.response.data.message);\n          });\n        } else {\n          return false;\n        }\n      });\n    }\n  }\n};\nexports.default = _default;",null]}